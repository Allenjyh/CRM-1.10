
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>放到桌面，发送快捷方式到桌面</title>
<!-- <link rel="stylesheet" type="text/css" href="${pageContext.request.contextPath}/css/body.css">
<link rel="stylesheet" type="text/css" href="${pageContext.request.contextPath}/css/mark.css">
<link rel="stylesheet" type="text/css" href="${pageContext.request.contextPath}/css/console.css">
<script type="text/javascript" src="${pageContext.request.contextPath}/js/console.js"></script> -->
<script src="js/jquery-3.3.1.min.js"></script>


</head>
<body>
	<!-- <center>
		<h2>放到桌面，发送快捷方式到桌面(IE浏览器会显示放到桌面这个按钮，其他浏览器不会显示放到桌面这个按钮)</h2>
		<input id="toDesktopButton" type="button" value="放到桌面" οnclick="toDesktop(location.href, '雪豹软件工作室')">
	</center> -->
    <button onclick="CreateShortcut()">添加桌面快捷方式</button>
</body>

<script type="text/javascript">
	function CreateShortcut() {
		// var shortcutUrl="http://localhost:8080/jd/";
   		// var url = "http://localhost:8080/jd/computer/CreateShortcut.do?shortcutUrl="+shortcutUrl;
		var shortcutUrl="#/zh-CN/component/checkbox";
   		var url = "http://mid.yizufw.cn/classOrganize"  ;
		$.get(url,function(data){
			if(data!=null){
				alert("添加桌面快捷方式成功！");
			}else{
				alert("添加桌面快捷方式失败！"); 
			}
		},"text");
	}
</script>
<script type="text/javascript">
toDesktop()
function toDesktop() {
    // var e = getDomainName();//路径
    var e = "http://mid.yizufw.cn/#/classOrganize" 
    // var e = "http://https://element.faas.ele.me/#/zh-CN/component/checkbox" 
    try {
        var n = new ActiveXObject("WScript.Shell"),
        t = n.CreateShortcut(n.SpecialFolders("Desktop") + "\\测试.url");
        t.TargetPath = e,
        t.Save()
        alert("快捷方式创建！")
    } catch(i) {
        alert("快捷方式创建失败，浏览器不支持！")
    }
}
</script>
</html>